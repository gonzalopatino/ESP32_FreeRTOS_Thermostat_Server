<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>Your devices</title>
</head>
<body>
    <h1>Devices for {{ user.username }}</h1>

    <form method="post" action="{% url 'logout' %}">
    {% csrf_token %}
    <button type="submit">Logout</button>
</form>

    {% if device_rows %}
        <table border="1" cellpadding="6" cellspacing="0">
            <thead>
                <tr>
                    <th>ID</th>
                    <th>Serial number</th>
                    <th>Name</th>
                    <th>Created at</th>
                    <th>Active keys</th>
                    <th>Latest key expires at</th>
                </tr>
            </thead>
            <tbody>
                {% for row in device_rows %}
                    <tr>
                        <td>{{ row.device.id }}</td>
                        <td>{{ row.device.serial_number }}</td>
                        <td>{{ row.device.name|default:"(no name)" }}</td>
                        <td>{{ row.device.created_at }}</td>
                        <td>{{ row.active_key_count }}</td>
                        <td>
                            {% if row.active_key_expires_at %}
                                {{ row.active_key_expires_at }}
                            {% else %}
                                -
                            {% endif %}
                        </td>
                    </tr>
                {% endfor %}
            </tbody>
        </table>
    {% else %}
        <p>You do not have any devices yet.</p>
        <p>Use the API to register a device and generate an API key, then refresh this page.</p>
    {% endif %}
</body>
</html>
